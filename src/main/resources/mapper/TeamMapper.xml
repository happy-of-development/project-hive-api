<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hod.project.hive.mapper.TeamMapper">

    <insert id="addTeam" parameterType="com.hod.project.hive.dto.TeamRequest">
        INSERT INTO tb_team (
            name,
            description,
            created_id,
            created_date,
            modified_id,
            modified_date
            )
        VALUES (
            #{team.name},
            #{team.desc},
            '10000000',
            NOW(),
            '10000000',
            NOW()
            )
    </insert>

    <select id="findTeam" parameterType="String" resultType="com.hod.project.hive.dto.TeamUserResponse">
        SELECT t.id id,
               t.name name,
               t.description desc,
        FROM tb_team t
        WHERE t.id = #{id};
    </select>

    <update id="updateTeam" parameterType="com.hod.project.hive.dto.TeamRequest">
        UPDATE tb_team t
        SET t.name = #{team.name},
            t.description = #{team.desc},
            t.modified_date = NOW()
        WHERE t.id = #{team.id}
    </update>

    <delete id="deleteTeam">
        DELETE
        FROM tb_team
        WHERE id = #{id}
    </delete>

    <delete id="deleteTeamUser">
        DELETE
        FROM tb_team_user
        WHERE team_id = #{id}
    </delete>

    <select id="findTeamUserList" resultType="com.hod.project.hive.dto.TeamUserResponse$TeamUser">
        SELECT u.name userName
        FROM tb_team_user tu
        JOIN tb_user u
            ON tu.user_id = u.id
        WHERE tu.team_id = #{id};
    </select>
</mapper>